Оставляю код в прежнем виде, пока вроде есть соответствие с процедурным стилем.
Все основные команды выделены в отдельные маленькие функции, которые ничего не возвращают.
Также главный метод, пробегаясь по списку строк на входе, преобразует каждую команду
в объект интерфейса Command и передает полиморфной функции invokeCommand() на вход.